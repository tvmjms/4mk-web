(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[724],{681:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var a=s(7876),d=s(7328),r=s.n(d),l=s(8230),n=s.n(l),i=s(9367),c=s(4232);function o(){let e=(0,i.useUser)(),t=(0,i.useSupabaseClient)(),[s,d]=(0,c.useState)([]),[l,o]=(0,c.useState)([]),[x,h]=(0,c.useState)(!0),[u,m]=(0,c.useState)(null);return(0,c.useEffect)(()=>{if(!e)return;let s=!1;return(async()=>{h(!0),m(null);try{let{data:a,error:r}=await t.from("needs").select("*").eq("owner_id",e.id).order("created_at",{ascending:!1});if(r)throw r;let{data:l,error:n}=await t.from("fulfillment").select("need_id, status").eq("helper_id",e.id).in("status",["accepted","fulfilled"]).order("created_at",{ascending:!1});if(n)throw n;let i=[];if(l&&l.length){let e=[...new Set(l.map(e=>e.need_id))],{data:s,error:a}=await t.from("needs").select("*").in("id",e);if(a)throw a;i=s||[]}s||(d(a||[]),o(i))}catch(e){var a;s||m(null!=(a=null==e?void 0:e.message)?a:"Failed to load dashboard")}finally{s||h(!1)}})(),()=>{s=!0}},[e,t]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r(),{children:(0,a.jsx)("title",{children:"My Dashboard — 4MK"})}),(0,a.jsx)("div",{className:"min-h-screen bg-[#373737] py-8 px-3",children:(0,a.jsxs)("div",{className:"mx-auto max-w-6xl rounded-[28px] bg-gradient-to-b from-pink-200 to-pink-300 p-6 md:p-10 shadow-[0_22px_70px_rgba(0,0,0,0.45)] ring-2 ring-[#E3B341]",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h1",{className:"text-3xl font-extrabold text-neutral-900",children:"My Dashboard"}),(0,a.jsx)(n(),{href:"/",className:"text-sm underline text-neutral-800",children:"← Back to Home"})]}),x&&(0,a.jsx)("div",{className:"mt-6 text-neutral-800",children:"Loading…"}),u&&(0,a.jsxs)("div",{className:"mt-6 text-red-700",children:["Error: ",u]}),!x&&!u&&(0,a.jsxs)("div",{className:"mt-6 grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsx)("div",{className:"rounded-2xl bg-[#6d5d5c]/80 p-3 md:p-4 shadow-xl",children:(0,a.jsxs)("div",{className:"rounded-2xl bg-white/70 p-3 shadow",children:[(0,a.jsx)("div",{className:"mb-2 text-lg font-semibold text-neutral-900",children:"My Posted Needs"}),(0,a.jsxs)("div",{className:"space-y-2",children:[0===s.length&&(0,a.jsx)("div",{className:"text-sm text-neutral-700",children:"No needs posted yet."}),s.map(e=>{var t,s;return(0,a.jsxs)("a",{href:"/needs/".concat(e.id),className:"block rounded-xl bg-white shadow border border-neutral-300 px-3 py-2 hover:border-neutral-400",children:[(0,a.jsx)("div",{className:"text-xs text-neutral-500",children:new Date(e.created_at).toLocaleString()}),(0,a.jsx)("div",{className:"text-sm font-semibold text-neutral-900",children:e.title}),(0,a.jsxs)("div",{className:"text-xs text-neutral-700",children:[null!=(t=e.city)?t:"",e.state?", ".concat(e.state):""," • ",null!=(s=e.category)?s:"other"]})]},e.id)})]})]})}),(0,a.jsx)("div",{className:"rounded-2xl bg-[#6d5d5c]/80 p-3 md:p-4 shadow-xl",children:(0,a.jsxs)("div",{className:"rounded-2xl bg-white/70 p-3 shadow",children:[(0,a.jsx)("div",{className:"mb-2 text-lg font-semibold text-neutral-900",children:"Offers I Accepted"}),(0,a.jsxs)("div",{className:"space-y-2",children:[0===l.length&&(0,a.jsx)("div",{className:"text-sm text-neutral-700",children:"No accepted offers yet."}),l.map(e=>{var t,s;return(0,a.jsxs)("a",{href:"/needs/".concat(e.id),className:"block rounded-xl bg-white shadow border border-neutral-300 px-3 py-2 hover:border-neutral-400",children:[(0,a.jsx)("div",{className:"text-xs text-neutral-500",children:new Date(e.created_at).toLocaleString()}),(0,a.jsx)("div",{className:"text-sm font-semibold text-neutral-900",children:e.title}),(0,a.jsxs)("div",{className:"text-xs text-neutral-700",children:[null!=(t=e.city)?t:"",e.state?", ".concat(e.state):""," • ",null!=(s=e.category)?s:"other"]})]},e.id)})]})]})})]})]})})]})}},7328:(e,t,s)=>{e.exports=s(9269)},7721:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return s(681)}])}},e=>{e.O(0,[636,593,792],()=>e(e.s=7721)),_N_E=e.O()}]);