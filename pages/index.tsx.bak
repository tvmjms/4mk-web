// pages/index.tsx
import Link from 'next/link'
import Head from 'next/head'
import { useEffect, useState } from 'react'
import { supabase } from '@/lib/supabase'

export default function Home() {
  const [email, setEmail] = useState<string | null>(null)

  useEffect(() => {
    let mounted = true
    ;(async () => {
      const { data } = await supabase.auth.getUser()
      if (mounted) setEmail(data.user?.email ?? null)
    })()
    const { data: sub } = supabase.auth.onAuthStateChange((_e, session) => {
      setEmail(session?.user?.email ?? null)
    })
    return () => sub.subscription.unsubscribe()
  }, [])

  return (
    <>
      <Head><title>4MK</title></Head>
      <main className="bg-gradient-to-b from-indigo-50 to-indigo-100">
        <section className="mx-auto max-w-6xl px-4 py-16">
          <div className="mx-auto max-w-3xl text-center rounded-2xl bg-white/70 shadow p-10">
            <h1 className="text-4xl md:text-5xl font-extrabold text-indigo-700 mb-4">
              ðŸŽ‰ Welcome to 4MK
            </h1>
            <p className="text-gray-700 mb-8">
              Connect. Collaborate. Contribute. Manage needs and offers in your community effortlessly.
            </p>

            <div className="flex items-center justify-center gap-4">
              <Link
                href="/needs"
                className="px-5 py-3 rounded-lg border font-semibold hover:bg-indigo-50"
              >
                View Needs
              </Link>

              <Link
                href="/needs/create"
                className="px-5 py-3 rounded-lg border font-semibold bg-white hover:bg-indigo-50"
              >
                Create Need
              </Link>

              <Link
                href="/dashboard"
                className="px-5 py-3 rounded-lg bg-indigo-600 text-white font-semibold hover:bg-indigo-700"
              >
                My Dashboard
              </Link>
            </div>

            {!email && (
              <p className="mt-6 text-sm text-gray-500">
                Youâ€™re not signed in yet. Visit your Dashboard to sign in.
              </p>
            )}

            <div className="mt-10 text-xs tracking-widest text-indigo-400">
              EMPOWERING CONNECTIONS
              <div className="mx-auto mt-2 h-1 w-40 bg-indigo-300 rounded-full" />
            </div>
          </div>
        </section>
      </main>
    </>
  )
}
